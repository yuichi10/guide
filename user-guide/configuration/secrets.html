<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="All you need to know about Screwdriver and more">
    
    
    <link rel="shortcut icon" href="/themes/sd/img/favicon.ico">

    <title>Secrets - Screwdriver Guide</title>

    <link href="/themes/sd/css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="/themes/sd/css/font-awesome-4.5.0.css" rel="stylesheet">
    <link href="/themes/sd/css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="/themes/sd/css/highlight.css">
    
    <link href="/css/homepage.css" rel="stylesheet">
    
    <link href="/css/navbar.css" rel="stylesheet">
    
    <link href="/css/yaml.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-88158708-1', 'docs.screwdriver.cd');
        ga('send', 'pageview');
    </script>
    
</head>

<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="http://screwdriver.cd">Screwdriver Guide</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#jekyll_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/screwdriver-cd/guide">
                        
                        <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
        <div class="navbar-collapse collapse">
            
            <div class="navbar-title col-md-12">
                Secrets
            </div>
            
        </div>
        <div class="navbar-collapse collapse">
            
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
                
                
                <li >
                    <a href="/">Home</a>
                </li>
                
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cluster Management <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
<li >
    <a href="/cluster-management/">Overall Architecture</a>
</li>


                        
                        
<li >
    <a href="/cluster-management/configure-api">Configuring the API</a>
</li>


                        
                        
<li >
    <a href="/cluster-management/configure-ui">Configuring the UI</a>
</li>


                        
                        
<li >
    <a href="/cluster-management/configure-store">Configuring the Store</a>
</li>


                        
                        
<li >
    <a href="/cluster-management/running-locally">Running Locally</a>
</li>


                        
                        
<li class="dropdown-submenu">
    <a tabindex="-1" href="">Examples</a>
    <ul class="dropdown-menu">
        
        
<li >
    <a href="/cluster-management/kubernetes">Kubernetes</a>
</li>


        
    </ul>
</li>


                        
                    </ul>
                </li>
                
                
                
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
<li >
    <a href="/user-guide/quickstart">Quickstart</a>
</li>


                        
                        
<li >
    <a href="/user-guide/api">API</a>
</li>


                        
                        
<li >
    <a href="/user-guide/authentication-authorization">Authentication and Authorization</a>
</li>


                        
                        
<li class="dropdown-submenu">
    <a tabindex="-1" href="">Configuration</a>
    <ul class="dropdown-menu">
        
        
<li >
    <a href="/user-guide/configuration/">Overall</a>
</li>


        
        
<li >
    <a href="/user-guide/configuration/metadata">Metadata</a>
</li>


        
        
<li >
    <a href="/user-guide/configuration/secrets">Secrets</a>
</li>


        
    </ul>
</li>


                        
                        
<li >
    <a href="/user-guide/environment-variables">Environment Variables</a>
</li>


                        
                        
<li >
    <a href="/user-guide/templates">Templates</a>
</li>


                        
                        
<li >
    <a href="/user-guide/FAQ">FAQ</a>
</li>


                        
                    </ul>
                </li>
                
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
<li >
    <a href="/about">What is Screwdriver?</a>
</li>


                        
                        
<li class="dropdown-submenu">
    <a tabindex="-1" href="">Appendix</a>
    <ul class="dropdown-menu">
        
        
<li >
    <a href="/about/appendix/domain">Domain Model</a>
</li>


        
        
<li >
    <a href="/about/appendix/execution-engines">Execution Engines</a>
</li>


        
    </ul>
</li>


                        
                        
<li >
    <a href="/about/contributing">Contributing</a>
</li>


                        
                        
<li >
    <a href="/about/support">Support</a>
</li>


                        
                    </ul>
                </li>
                
                
            </ul>
            
        </div>
    </div>
</div>

<div class="container">
    
    
    <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        
        
        <li class="main active"><a href="#build-secrets">Build Secrets</a></li>
        
        
        
        <li><a href="#security">Security</a></li>
        
        
        
        <li><a href="#configuring-a-job-to-expose-secrets">Configuring a job to expose secrets</a></li>
        
        
        
        <li><a href="#user-interface">User Interface</a></li>
        
        
    </ul>
</div>
</div>
    
    <div class="col-md-9" role="main">
    <h1 id="build-secrets">Build Secrets</h1>
<p>You’ve got secrets to share with your jobs, but these shouldn’t be shared with everyone. Screwdriver provides a mechanism to insert secrets as environment variables. Since secrets are exposed as environment variables, they are easy to use inside builds.</p>

<h2 id="security">Security</h2>
<p>The Screwdriver team takes security very seriously and encrypts all traffic between its various services. User secrets are stored encrypted in our datastore, and their values are only released to those builds that are authorized by the user.</p>

<p>We understand that you, the security-conscious pipeline admin, may not wish to put secrets into pull-request builds, as a malicious pull-requester could expose those secrets without your consent, but still need those secrets as part of the main build. Screwdriver provides an additional flag on secrets, <code class="highlighter-rouge">allowInPR</code> (default: false), that is required to be enabled for a secret to be exposed.</p>

<p>Secrets may only be added, modified, or removed by people that are listed as admins of the Git repository associated with a given pipeline. People with “push” privileges may also fetch a list of secrets, but not the secret values.</p>

<h2 id="configuring-a-job-to-expose-secrets">Configuring a job to expose secrets</h2>
<p>A list of allowed secrets are added to your pipeline configuration. Secret keys may only contain A-Z and underscore characters ( _ ) and must start with a letter.</p>

<p>In the below example, an <code class="highlighter-rouge">NPM_TOKEN</code> secret is added to the <code class="highlighter-rouge">publish</code> job:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">publish</span><span class="pi">:</span>
    <span class="s">steps</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">publish-npm</span><span class="pi">:</span> <span class="s">npm publish</span>
    <span class="s">secrets</span><span class="pi">:</span>
        <span class="c1"># Publishing to NPM</span>
        <span class="pi">-</span> <span class="s">NPM_TOKEN</span>
</code></pre>
</div>

<p>You may add secrets to any jobs you wish.</p>

<h3 id="secrets-in-pull-requests">Secrets in pull-requests</h3>
<p>For your own security, we don’t recommend exposing secrets to pull-request builds. Pull-request jobs can be created with modified <code class="highlighter-rouge">screwdriver.yaml</code> files including changes to the secrets configuration.</p>

<p>Pull-requests operate essentially as copies of the <code class="highlighter-rouge">main</code> job. The <code class="highlighter-rouge">main</code> job can be set up to use a secret, and does not expose that secret to pull-requests by default.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">main</span><span class="pi">:</span>
    <span class="s">steps</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">my-step</span><span class="pi">:</span> <span class="s">maybeDoSomethingWithASecret.sh</span>
    <span class="s">secrets</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">MY_SECRET</span>
</code></pre>
</div>

<p>When a secret is created via the UI, or API, enabling <code class="highlighter-rouge">allowInPR</code> will cause that secret to be available to pull-request builds, if those secrets are also configured to be exposed in the <code class="highlighter-rouge">main</code> job.</p>

<h2 id="user-interface">User Interface</h2>
<p>The easiest way to create a secret for your pipeline is via the Screwdriver UI.
<img src="../../assets/secrets.png" alt="Secrets UI" /></p>

<h3 id="creating-secrets">Creating Secrets</h3>
<p>Simply enter the key and value in the inputs in the grey box, and click the add button. A checkbox is provided to allow you to enable <code class="highlighter-rouge">allowInPR</code>.</p>

<h3 id="updating-secrets">Updating Secrets</h3>
<p>A secret’s original value is never delivered to the UI, but values of secrets may be updated in the UI by adding a new value in the text field next to the appropriate key name and clicking the update button.</p>

<h3 id="deleting-secrets">Deleting secrets</h3>
<p>Individual secrets may be removed by clicking the Delete button.</p>

</div>
    
</div>

<footer>
    <div class="container">
        <div class="col-xs-6">
            <p>All code on this site is licensed under the <a href="https://github.com/screwdriver-cd/screwdriver/blob/master/LICENSE">Yahoo BSD License</a> unless otherwise stated.</p>
        </div>
        <div class="col-xs-6">
            
            <p>© 2016 Yahoo! Inc. All rights reserved.</p>
            
        </div>
    </div>
</footer>

<script src="/themes/sd/js/jquery-1.10.2.min.js"></script>
<script src="/themes/sd/js/bootstrap-3.0.3.min.js"></script>
<script src="/themes/sd/js/highlight.pack.js"></script>
<script>var base_url = '';</script>
<script>var page_menu = 'menu';</script>
<script src="/themes/sd/js/base.js"></script>


<script src="/js/vendor/jquery-3.1.0.min.js"></script>


<script src="/js/yaml.js"></script>


<script src="/js/lunr.min.js"></script>


<script src="/js/lunr-feed.js"></script>


<div class="modal" id="jekyll_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">x</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <input type="search" class="form-control" id="search" placeholder="Search..." autocomplete="off">
                </form>
                <div id="results" class="all-posts results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

</body>
</html>

